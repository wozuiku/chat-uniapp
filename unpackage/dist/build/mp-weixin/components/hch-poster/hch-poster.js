(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/hch-poster/hch-poster"],{"2d87":function(t,e,n){"use strict";n.r(e);var a=n("6391"),r=n("7703");for(var s in r)"default"!==s&&function(t){n.d(e,t,(function(){return r[t]}))}(s);n("c9d6");var o,i=n("f0c5"),c=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],o);e["default"]=c.exports},4504:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(n("a34a")),r=n("3772");function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n,a,r,s,o){try{var i=t[s](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(a,r)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var s=t.apply(e,n);function i(t){o(s,a,r,i,c,"next",t)}function c(t){o(s,a,r,i,c,"throw",t)}i(void 0)}))}}var c={data:function(){return{system:{},canvasShow:!1}},props:{posterData:{type:Object,default:function(){return{}}}},computed:{poster:function(){var t=this.posterData,e=this.system,n={url:t.poster.url,r:t.poster.r*e.scale,w:t.poster.w*e.scale,h:t.poster.h*e.scale,x:(e.w-t.poster.w*e.scale)/2,y:(e.h-t.poster.h*e.scale)/2,p:t.poster.p*e.scale};return n},mainImg:function(){var t=this.posterData,e=this.system,n={url:t.mainImg.url,r:t.mainImg.r*e.scale,w:t.mainImg.w*e.scale,h:t.mainImg.h*e.scale,x:(e.w-t.mainImg.w*e.scale)/2,y:this.poster.y+t.poster.p*e.scale};return n},title:function(){var t=this.posterData,e=this.system,n=t.title;return n.x=this.mainImg.x,n.y=this.mainImg.y+this.mainImg.h+t.title.mt*e.scale,n},codeImg:function(){var t=this.posterData,e=this.system,n={url:t.codeImg.url,r:t.codeImg.r*e.scale,w:t.codeImg.w*e.scale,h:t.codeImg.h*e.scale,x:(e.w-t.codeImg.w*e.scale)/2,y:t.codeImg.mt*e.scale};return n}},created:function(){this.system=(0,r.getSystem)()},methods:{posterShow:function(){this.canvasShow=!0,this.creatPoster()},creatPoster:function(){var e=this;return i(a.default.mark((function n(){var s,o,i,c,u,l,h;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.showLoading({title:"生成海报中..."}),s=t.createCanvasContext("myCanvas",e),e.ctx=s,s.clearRect(0,0,e.system.w,e.system.h),s.draw(),o=e.poster,i=e.mainImg,c=e.codeImg,u=e.title,n.next=11,(0,r.drawSquarePic)(s,o.x,o.y,o.w,o.h,o.r,o.url);case 11:return n.next=13,(0,r.drawSquarePic)(s,i.x,i.y,i.w,i.h,i.r,i.url);case 13:return console.log("creatPoster -> title.x",u.x),l=(0,r.drawTextReturnH)(s,u.text,u.x,u.y,i.w,u.fontSize,u.color,u.lineHeight),n.next=17,(0,r.drawSquarePic)(s,c.x,c.y+l,c.w,c.h,c.r,c.url);case 17:h=0,e.posterData.tips.forEach((function(t,e){0==e?h=c.y+l+t.mt+c.h:h+=t.mt,h=(0,r.drawTextReturnH)(s,t.text,u.x,h,i.w,t.fontSize,t.color,t.lineHeight,t.align)})),t.hideLoading();case 20:case"end":return n.stop()}}),n)})))()},handleSaveCanvasImage:function(){t.showLoading({title:"保存中..."});var e=this;t.canvasToTempFilePath({x:this.poster.x,y:this.poster.y,width:this.poster.w,height:this.poster.h,destWidth:5*this.poster.w,destHeight:5*this.poster.h,canvasId:"myCanvas",success:function(n){t.saveImageToPhotosAlbum({filePath:n.tempFilePath,success:function(n){t.hideLoading(),t.showToast({title:"图片保存成功，可以去分享啦~",duration:2e3,icon:"none"}),e.handleCanvasCancel()},fail:function(){t.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"}),t.hideLoading()}})},fail:function(e){console.log("fail -> res",e),t.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"}),t.hideLoading()}},this)},handleCanvasCancel:function(){this.canvasShow=!1,this.$emit("cancel",!0)}}};e.default=c}).call(this,n("543d")["default"])},6391:function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));var r=function(){var t=this,e=t.$createElement;t._self._c},s=[]},7703:function(t,e,n){"use strict";n.r(e);var a=n("4504"),r=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e["default"]=r.a},b79d:function(t,e,n){},c9d6:function(t,e,n){"use strict";var a=n("b79d"),r=n.n(a);r.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/hch-poster/hch-poster-create-component',
    {
        'components/hch-poster/hch-poster-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("2d87"))
        })
    },
    [['components/hch-poster/hch-poster-create-component']]
]);
